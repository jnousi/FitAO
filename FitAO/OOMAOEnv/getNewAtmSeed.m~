function [tel,atm] = getNewAtmSeed(seed,flag)
    
    addpath([pwd '/OOMAO-master']);    
        
  
    nLayer = 3;
    
    rng(seed)
    windSpeed     = rand(1,nLayer).*0 + [20,8,15];
    windDirection = [0, pi/4 , pi/2];
            
    nLenslet = 40;
    nPx = nLenslet*10;


   tel = telescope(8.2,...
           'fieldOfViewInArcMin',2.5,...
           'resolution',nPx,...
           'samplingTime',1/1000, 'obStructionRatio', 0.14);
    
    ss = RandStream('mt19937ar','Seed',seed);
     
    atm = atmosphere(photometry.V,0.15,30,...
     'altitude',[0,4,10]*1e3,...
     'fractionnalR0',[0.7,0.25,0.05],...
     'windSpeed',windSpeed,...
     'windDirection',windDirection,'randStream',ss);

%     atm = atmosphere(photometry.V,0.15,30,...
%     'altitude',[0]*1e3,...
%     'fractionnalR0',1,...
%     'windSpeed',windSpeed,...
%     'windDirection',windDirection,'randStream',ss);

 
%     atm = atmosphere_seed(photometry.V,0.15,seed,30,...
%     'altitude',[0,4,10]*1e3,...
%     'fractionnalR0',[0.7,0.25,0.05],...
%     'windSpeed',windSpeed,...
%     'windDirection',windDirection);

    tel = tel+atm;

end
